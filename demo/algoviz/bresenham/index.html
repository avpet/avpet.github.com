<!DOCTYPE html>
<html>
<head>
    <title>Алгоритм Брезенхэма (Bresenham)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="bresenham.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <meta property="og:image" content="images/logo.png">
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>

<script type="text/javascript" src="./javascript/algorithm-visualization-opt.js"></script>
<script>
    com.avpet.algoviz.bresenham.BresenhamUI().main();
</script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <style>
/* To center images */
.center {
    text-align: center;
}

.wrapper {
    margin-left: auto;
    margin-right: auto;
    max-width: calc(1200px - 30px * 2);
    padding-left: 30px;
    padding-right: 30px;
}
</style>


<div class="page-content">
<div class="wrapper">
        <div class="post">


  <article class="post-content">

<p>Несмотря на всю сложность компьютерной графики, в ее основе лежит на удивление небольшое количество простых функций. Наиболее часто используемые графические функции-примитивы - рисование точки, окружностей, заливка областей, копирование блоков данных о цвете, и, конечно, рисование отрезков прямых. Последняя функция часто поддерживается в том числе и на аппаратном уровне.</p>

<p>Наверное, наиболее известный алгоритм, используемый для рисования прямых на растровом устройстве - это алгоритм Брезенхэма. Алгоритм Брезенхэма определяет, какие точки двумерного растра нужно закрасить, чтобы получить близкое приближение прямой линии между двумя заданными точками. Это один из старейших алгоритмов в машинной графике &mdash; он был разработан Джеком Элтоном Брезенхэмом (Jack Elton Bresenham) в компании IBM в 1962 году. Алгоритм Брезенхэма очень эффективен, поскольку не требует операций с числами с плавающей запятой, не требует деления, и довольно компактен.</p>

<p class="center"><img src="http://imgur.com/3oN7V04.png" alt="gras"></p>

<p>В основе алгоритма Брезенхэма лежит идея, что для того, при изображении приближенного представления прямой с помощью конечного числа пикселей, часть пикселей будет лежать непосредственно на этой прямой, а часть немного в стороне, хотя и в непосредственной близости от этой прямой. Отклонение данного пикселя от аппроксимируемой прямой называется погрешностью. 
Рассмотрим случай, где длина горизонтальной проекции отрезка прямой <em>X</em> больше, чем вертикальная <em>Y</em>. Например, предположим, что мы рисуем отрезок от <em>(0,0)</em> к <em>(5,2)</em>, как изображено ниже. Концы отрезка совпадают с центрами указанных пикселей. Однако, в остальном отрезок не пересекает ни один из центров промежуточных пикселей, а это значит, что остальные пиксели будут аппроксимировать отрезок. Подход, используемый алгоритмом Брезенхэма, состоит в том, чтобы, рисуя новый пиксель, смещаться на один пиксель вдоль оси с большей длиной проекции отрезка (например, в данном случае вдоль <em>X</em>), и смещаться вдоль оси с меньшей длиной проекции отрезка (<em>Y</em> в данном случае), если мы отклоняемся от прямой на расстояние, большее чем половина расстояния между пикселями.</p>

<p class="center"><img src="http://imgur.com/jCfvkEd.png" alt="gras"></p>

<p>Для того, чтобы следить за отклонением, нужно хранить и обновлять значение погрешности - т.е. насколько далеко мы отклонились по <em>Y</em> в данной координате, как показано ниже. Если мы обнаруживаем, что отклонение по <em>Y</em> привело к тому, что существует еще одна, более близкая координата по <em>Y</em>, чем текущая, то мы должны выбрать <em>Y</em> этой более близкой координаты в качестве текущей. Давайте проследим более детально на иллюстрации ниже, как именно будет вести себя алгоритм Брезенхэма. Начальный пиксель мы рисуем в позиции (0,0), стартовой точке отрезка. На этом этапе погрешность равна 0.</p>

<p>Поскольку длина проекции отрезка на ось <em>X</em> в данном случае является больше, то следующий пиксель будет иметь координату <em>X=1</em>. Координата <em>Y</em> следующей точки будет либо равна 0 (как и в предыдущей точке), либо 1 - в зависимости от того, какая их них ближе. В этом случае погрешность будет равна <em>B - A</em>. Чисто визуально можно заметить, что погрешность меньше, чем 1/2 расстояния между пикселями, так что координата <em>Y</em> не меняется при <em>X=1</em>, и мы рисуем следующий пиксель.</p>

<p>Третий пиксель имеет координату <em>X = 2</em>. Здесь погрешность уже равна <em>C - A</em>, что, очевидно, превышает 1/2 расстояния между пикселями, и значит, что следующий пиксель мы рисуем в <em>(2,1)</em>, а <em>1</em> отнимается от погрешности для того, чтобы учесть, что мы сдвинулись на <em>1</em> по <em>Y</em>. В этой точке погрешность равна <em>C - D</em>.</p>

<p class="center"><img src="http://imgur.com/4SZpU7y.png" alt="gras"></p>

<p>Четвертый пиксель имеет координату <em>X = 3</em>. Погрешность здесь равна <em>E - D</em>; поскольку это менее 1/2 межпиксельного расстояния, то <em>Y</em> мы не меняем. Четвертый пиксель рисуем в позиции (3,1).</p>

<p>Пятый пиксель находится имеет координату <em>X=4</em>. Погрешность здесь уже <em>F - D</em>, что превышает 1/2 межпиксельного расстояния, <em>Y</em> снова увеличивается на 1. Третий пиксель - в точке (4,2), и мы отнимаем 1 от погрешности. которая здесь уже составляет <em>G - F</em>.</p>

<p>И, наконец, шестой пиксель является конечной точкой отрезка. У этого пикселя координата <em>X = 5</em>. Погрешность здесь равна G - G, или 0, что означает, что точка находиться на исходной прямой.</p>

<p>Попробуем записать это в виде формул и затем - кода. Запишем конечную и начальную точки (0,0) и (5,2) отрезка как <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 4.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.246em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.624em, 1003.15em, 2.915em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.385em; border-left: 0px solid; width: 0px; height: 1.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mn>0</mn><mo>,</mo><mi>y</mi><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(x0, y0)</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 4.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.246em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.624em, 1003.15em, 2.915em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-14" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.385em; border-left: 0px solid; width: 0px; height: 1.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mn>1</mn><mo>,</mo><mi>y</mi><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">(x1, y1)</script>. Причем <em>x</em> растет вниз, <em>y</em> - вправо (так обычно устроена экранная система координат).</p>

<p>Таким образом, в нашем случае длина горизонтальной проекции <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 4.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.343em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.708em, 1003.3em, 2.747em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.168em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mn>1</mn><mo>−</mo><mi>x</mi><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">x1 - x0</script> и длина вертикальной проекции <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 4.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.149em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.708em, 1003.11em, 2.87em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-29" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-32" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.327em; border-left: 0px solid; width: 0px; height: 1.249em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mn>1</mn><mo>−</mo><mi>y</mi><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">y1 - y0</script>, причем длина горизонтальной проекции отрезка больше вертикальной, то есть наклон линии от горизонтали &mdash; менее 45°. Наша цель состоит в том, чтобы для каждого столбца <em>x</em> между <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33" style="width: 1.407em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.708em, 1001.03em, 2.687em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 1.013em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">x0</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 1.407em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.708em, 1000.99em, 2.676em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.998em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">x1</script> определить, какая строка y ближе всего к линии, и нарисовать точку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 2.958em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.277em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.624em, 1002.18em, 2.915em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.385em; border-left: 0px solid; width: 0px; height: 1.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">(x , y)</script>.</p>

<p>Общая формула линии между двумя точками:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 11.824em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.157em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.032em, 1009.06em, 3.433em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-52" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.21em, 1003.17em, 4.372em, -1000em); top: -4.698em; left: 50%; margin-left: -1.607em;"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-55" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-58" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(3.21em, 1003.33em, 4.249em, -1000em); top: -3.335em; left: 50%; margin-left: -1.683em;"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-61" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-64" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(0.86em, 1003.49em, 1.211em, -1000em); top: -1.286em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.486em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-69" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.053em; border-left: 0px solid; width: 0px; height: 2.847em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mfrac><mrow><mi>y</mi><mn>1</mn><mo>−</mo><mi>y</mi><mn>0</mn></mrow><mrow><mi>x</mi><mn>1</mn><mo>−</mo><mi>x</mi><mn>0</mn></mrow></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mn>0</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">y=\frac{y1-y0}{x1-x0}(x-x0)</script>

<p>Поскольку мы знаем колонку <em>x</em>, то строка <em>y</em> получается округлением к целому следующего значения:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 14.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.337em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.032em, 1011.3em, 3.433em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-75" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.21em, 1003.17em, 4.372em, -1000em); top: -4.698em; left: 50%; margin-left: -1.607em;"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-78" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(3.21em, 1003.33em, 4.249em, -1000em); top: -3.335em; left: 50%; margin-left: -1.683em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-84" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-87" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(0.86em, 1003.49em, 1.211em, -1000em); top: -1.286em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.486em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.066em;"></span></span></span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-92" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-96" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.053em; border-left: 0px solid; width: 0px; height: 2.847em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mfrac><mrow><mi>y</mi><mn>1</mn><mo>−</mo><mi>y</mi><mn>0</mn></mrow><mrow><mi>x</mi><mn>1</mn><mo>−</mo><mi>x</mi><mn>0</mn></mrow></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>x</mi><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>y</mi><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">y=\frac{y1-y0}{x1-x0}(x-x0) + y0</script>

<p>Однако, вычислять точное значение этого выражения нет необходимости. Достаточно заметить, что <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-97" style="width: 0.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.484em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.932em, 1000.48em, 2.87em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.327em; border-left: 0px solid; width: 0px; height: 0.96em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">y</script> уменьшается от <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-100" style="width: 1.262em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.969em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.708em, 1000.93em, 2.87em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-103" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.327em; border-left: 0px solid; width: 0px; height: 1.249em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">y0</script> и за каждый шаг мы добавляем к <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 0.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.581em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.932em, 1000.53em, 2.676em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">x</script> единицу и добавляем к <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-107" style="width: 0.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.484em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.932em, 1000.48em, 2.87em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.327em; border-left: 0px solid; width: 0px; height: 0.96em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">y</script> значение наклона (в нашем случае значение наклона будет отрицательным числом):</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" style="width: 7.125em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.523em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.032em, 1005.52em, 3.433em, -1000em); top: -2.519em; left: 0em;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-114" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.21em, 1003.17em, 4.372em, -1000em); top: -4.698em; left: 50%; margin-left: -1.607em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-117" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mn" id="MathJax-Span-120" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(3.21em, 1003.33em, 4.249em, -1000em); top: -3.335em; left: 50%; margin-left: -1.683em;"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mn" id="MathJax-Span-123" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mn" id="MathJax-Span-126" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.021em;"></span></span><span style="position: absolute; clip: rect(0.86em, 1003.49em, 1.211em, -1000em); top: -1.286em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.486em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.066em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.053em; border-left: 0px solid; width: 0px; height: 2.847em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>s</mi><mo>=</mo><mfrac><mrow><mi>y</mi><mn>1</mn><mo>−</mo><mi>y</mi><mn>0</mn></mrow><mrow><mi>x</mi><mn>1</mn><mo>−</mo><mi>x</mi><mn>0</mn></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">s=\frac{y1-y0}{x1-x0}</script>

<p>которое можно вычислить заранее. Более того, на каждом шаге мы делаем одно из двух: либо сохраняем тот же <em>y</em>, либо уменьшаем его на <em>1</em>.</p>

<p>Что из этих двух выбрать &mdash; можно решить, отслеживая значение погрешности, которое означает &mdash; вертикальное расстояние между текущим значением <em>y</em> и точным значением <em>y</em> для текущего <em>x</em>. Всякий раз, когда мы увеличиваем <em>x</em>, мы увеличиваем значение ошибки на величину наклона <em>s</em>, приведённую выше. Если ошибка превысила <em>0.5</em>, линия стала ближе к следующему <em>y</em>, поэтому мы уменьшаем <em>y</em> на единицу, одновременно уменьшая значение ошибки на <em>1</em>.</p>

<p>Ниже приведена реализация функции для аппроксимирования линии пикселями на Scala, полностью же реализация с отрисовкой находится <a href="https://github.com/avpet/algorithm-visualization/tree/master/src/main/scala/com/avpet/algoviz/bresenham">здесь</a></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala">  <span class="k">private</span> <span class="k">def</span> <span class="n">bresenham</span><span class="o">(</span><span class="n">ctx</span><span class="k">:</span> <span class="kt">CanvasContext</span><span class="o">,</span> <span class="n">x0</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y0</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">x1</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">y1</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">var</span> <span class="n">x</span> <span class="k">=</span> <span class="n">x0</span>
    <span class="k">var</span> <span class="n">y</span> <span class="k">=</span> <span class="n">y0</span>
    <span class="k">val</span> <span class="n">dx</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">abs</span><span class="o">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">dy</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">abs</span><span class="o">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">sx</span> <span class="k">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">x0</span> <span class="o">&lt;</span> <span class="n">x1</span><span class="o">)</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">val</span> <span class="n">sy</span> <span class="k">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="o">)</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">var</span> <span class="n">err</span> <span class="k">=</span> <span class="n">dx</span> <span class="o">-</span> <span class="n">dy</span>

    <span class="k">def</span> <span class="n">it</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">[</span><span class="kt">Point</span><span class="o">]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">next</span> <span class="k">=</span> <span class="o">{</span>
        <span class="k">val</span> <span class="n">p</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>

        <span class="k">val</span> <span class="n">e2</span> <span class="k">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">err</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e2</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">dy</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">err</span> <span class="o">-=</span> <span class="n">dy</span>
          <span class="n">x</span> <span class="o">+=</span> <span class="n">sx</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e2</span> <span class="o">&lt;</span> <span class="n">dx</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">err</span> <span class="o">+=</span> <span class="n">dx</span>
          <span class="n">y</span> <span class="o">+=</span> <span class="n">sy</span>
        <span class="o">}</span>
        <span class="n">p</span>
      <span class="o">}</span>

      <span class="k">def</span> <span class="n">hasNext</span> <span class="k">=</span> <span class="o">!((</span><span class="n">x</span> <span class="o">==</span> <span class="n">x1</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">y1</span><span class="o">))</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="n">p</span> <span class="k">&lt;-</span> <span class="n">it</span><span class="o">)</span> <span class="n">drawPixel</span><span class="o">(</span><span class="n">ctx</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="s">"black"</span><span class="o">)</span>
  <span class="o">}</span></code></pre></figure>


  </article>
<p>Источники:</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm">https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm</a></li>
  <li><a href="https://www.amazon.com/Michael-Abrashs-Graphics-Programming-Special/dp/1576101746">https://www.amazon.com/Michael-Abrashs-Graphics-Programming-Special/dp/1576101746</a></li>
  <li><a href="http://stackoverflow.com/questions/4672279/bresenham-algorithm-in-javascript">http://stackoverflow.com/questions/4672279/bresenham-algorithm-in-javascript</a></li>
</ul>

</div>

      </div>
      </div>

      </div>
</body>
</html>
